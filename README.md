# Система автоматической сортировки отходов (CV3)

Система классификации отходов с использованием глубокого обучения для экологической устойчивости.

## Описание проекта

Этот проект реализует систему автоматической классификации отходов на основе компьютерного зрения. Модель обучена распознавать и категоризировать различные типы отходов: пластик, стекло, бумагу, металл и органические отходы.

## Технологии

- **Python 3.8+**
- **PyTorch** - для глубокого обучения
- **OpenCV** - для обработки изображений
- **scikit-learn** - для метрик и разделения данных
- **matplotlib/seaborn** - для визуализации

## Структура проекта

```
recycle-classifier/
├── data_loader.py          # Загрузка и предобработка данных
├── model.py                # Архитектура модели
├── train.py                # Скрипт обучения
├── evaluate.py             # Оценка модели с визуализацией
├── predict.py              # Предсказания на новых изображениях
├── requirements.txt        # Зависимости
├── README.md              # Документация
├── garbage-dataset/       # Датасет с изображениями
│   ├── plastic/
│   ├── glass/
│   ├── paper/
│   ├── metal/
│   └── biological/
├── models/                # Сохраненные модели (создается автоматически)
└── results/               # Результаты и визуализации (создается автоматически)
```

## Установка

1. Клонируйте репозиторий или скачайте проект

2. Установите зависимости:

```bash
pip install -r requirements.txt
```

## Использование

### 1. Обучение модели

Для обучения модели на вашем датасете:

```bash
python train.py --data_dir garbage-dataset --epochs 20 --lr 0.001
```

Параметры:

- `--data_dir`: путь к директории с данными (по умолчанию: `garbage-dataset`)
- `--epochs`: количество эпох обучения (по умолчанию: 20)
- `--lr`: learning rate (по умолчанию: 0.001)
- `--batch_size`: размер батча (по умолчанию: 32)

Модель будет сохранена в `models/best_model.pth` (лучшая модель по валидации).

### 2. Оценка модели

Для оценки обученной модели на тестовой выборке:

```bash
python evaluate.py --model_path models/best_model.pth --data_dir garbage-dataset
```

Этот скрипт создаст:

- Confusion matrix (матрицу ошибок)
- Нормализованную confusion matrix
- График точности по классам
- График распределения классов
- Classification report с метриками

Все результаты сохраняются в директории `results/`.

### 3. Предсказания на новых изображениях

#### Одно изображение:

```bash
python predict.py --image path/to/image.jpg --model_path models/best_model.pth
```

#### Несколько изображений из директории:

```bash
python predict.py --image_dir path/to/images/ --num_images 10 --model_path models/best_model.pth
```

## Датасет

Проект использует датасет с изображениями отходов, организованный по категориям:

- **plastic** - пластик
- **glass** - стекло
- **paper** - бумага
- **metal** - металл
- **biological** - органические отходы (пищевые отходы)

Рекомендуется иметь минимум 150-200 изображений на категорию для качественного обучения.

## Архитектура модели

Модель использует предобученную ResNet18 в качестве backbone с дополнительными слоями:

- Dropout для регуляризации
- Полносвязные слои для классификации
- Transfer learning для ускорения обучения

## Результаты

После обучения и оценки вы получите:

1. **График обучения** (`results/training_history.png`) - показывает loss и accuracy на train/validation
2. **Confusion Matrix** (`results/confusion_matrix.png`) - матрица ошибок классификации
3. **Точность по классам** (`results/class_accuracy.png`) - график точности для каждого класса
4. **Распределение классов** (`results/class_distribution.png`) - количество примеров по классам

## Примеры использования в коде

```python
from data_loader import load_dataset
from model import WasteClassifier
import torch

# Загрузка данных
train_loader, val_loader, test_loader, class_names = load_dataset("garbage-dataset")

# Создание модели
model = WasteClassifier(num_classes=5, pretrained=True)
```

## Требования к системе

- Python 3.8 или выше
- CUDA (опционально, для ускорения на GPU)
- Минимум 4GB RAM (рекомендуется 8GB+)
- Свободное место на диске для сохранения моделей и результатов

## Лицензия

Этот проект создан в образовательных целях.

## Автор

Проект выполнен в рамках курса AI_Huawei.
